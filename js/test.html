<html>
    <head>
	<script type="text/javascript" src="ppp/Base.js"></script>
	<script type="text/javascript" src="ppp/util.js"></script>
	<script type="text/javascript" src="sha256.js"></script>
	<script type="text/javascript" src="util.sha256.js"></script>
	<script type="text/javascript" src="util.hmac.js"></script>
	<script type="text/javascript">
	    var s = UTIL.get_random_key(100*1024);
	    var hash;
	    var hmac;
	    function pr(s) {
		document.body.appendChild(document.createTextNode(s));
	    }
	    function prln(s) {
		pr(s);
		document.body.appendChild(document.createElement("br"));
	    }
	    function profile(fun) {
		console.profile();
		fun();
		console.profileEnd();
	    }
	    function run_prof() {
		profile(function() {
		     return sha256_digest(s); 
		});
		profile(function() {
		    return (new UTIL.SHA256.Hash()).update(s).digest();
		});
	    }

	    window.onload = function() {
		hash = new UTIL.SHA256.Hash();
		Hmac = new HMAC(UTIL.SHA256.Hash);
		hmac = Hmac.get("foo");
		prln("hmac(foo)(bar): "+hmac.hmac("bar"));
		prln("verify sha256 legacy: "+sha256_self_test());
		prln("verify UTIL.SHA256: "+UTIL.SHA256.self_test());

		pr("legacy sha256: ");
		prln((s.length / UTIL.gauge(function () {
								 return sha256_digest(s); 
							     }) / 1024).toFixed(2) + " kb/s");
		pr("UTIL.SHA256: ");
		prln((s.length / UTIL.gauge(function () { 
								return (new UTIL.SHA256.Hash()).update(s).digest();
							     }) / 1024).toFixed(2) + " kb/s");
	    };


	</script>
    </head>
    <body>
	use the console!<br>
    </body>
</html>
